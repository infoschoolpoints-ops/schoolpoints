# ✨ מערכת ניקוד בית ספר - גרסה 7.4
════════════════════════════════════════════════════════════════

🎓 מערכת ניהול נקודות ומעקב תלמידים עם כרטיסי RFID


════════════════════════════════════════════════════════════════
📋 קבצי הפעלה עיקריים
════════════════════════════════════════════════════════════════

▶️ run_admin.bat / run_admin.pyw
   עמדת ניהול - ניהול תלמידים, נקודות והודעות

▶️ run_public.bat / run_public.pyw
   עמדה ציבורית - הצגת נקודות לתלמידים

▶️ run_cashier.pyw
   עמדת קופה - מכירות/רכישות/קטלוג מוצרים (אם הופעל במערכת)

▶️ run_messages.bat
   מנהל הודעות - הודעות כלליות, הודעות לפי נקודות, הודעות פרטיות, חדשות/טיקר ופרסומות

▶️ color_editor.pyw
   עורך צבעים - התאמה אישית של צבעי הממשק


════════════════════════════════════════════════════════════════
🚀 הדרכה מהירה
════════════════════════════════════════════════════════════════

1️⃣ התקנה ראשונית (מחשב חדש):
   לחץ פעמיים: התקן_חבילות.bat
   או:
   python -m pip install -r requirements.txt

2️⃣ בדיקת מערכת:
   לחץ פעמיים: בדוק_מערכת.bat

3️⃣ הפעלה:
   • עמדת ניהול: run_admin.pyw
   • עמדה ציבורית: run_public.pyw
   • מנהל הודעות: run_messages.bat

הערה על הפעלה ללא CMD:
   • עמדת ניהול/ציבורית מומלץ להפעיל דרך קבצי .pyw (ללא חלון שחור)
   • מנהל הודעות מופעל כרגע דרך .bat ולכן יופיע חלון CMD (זה תקין)

4️⃣ ייבוא תלמידים:
   • פתח עמדת ניהול
   • לחץ "ייבוא מ-Excel"
   • בחר את קובץ האקסל


════════════════════════════════════════════════════════════════
🧩 מבנה עמדות (Multi-Station) - הכי חשוב לסנכרון בין מחשבים
════════════════════════════════════════════════════════════════

כדי שכל העמדות יעבדו עם אותם נתונים (תלמידים, נקודות, הודעות, בונוסים, הגדרות תצוגה וכו'),
יש 2 קבצים שקובעים את ה"חיבור" לרשת:

1) db_path.txt
   - מכיל את הנתיב למסד הנתונים המשותף (SQLite)
   - דוגמה: \\SERVER\SchoolPoints\school_points.db

2) excel_path.txt
   - מכיל את הנתיב לקובץ ה-Excel המשותף
   - דוגמה: \\SERVER\SchoolPoints\טבלה למבצע אשראי.xlsx

כל עוד כל המחשבים מצביעים לאותם נתיבים - המידע יהיה משותף.

קבצי עזר חשובים:
• master_card.txt - כרטיס מאסטר (ליציאה/ניהול בעמדה ציבורית)
• bonus_settings.json / color_settings.json / config.json - הגדרות מערכת


════════════════════════════════════════════════════════════════
✨ תכונות עיקריות
════════════════════════════════════════════════════════════════

✅ ניהול תלמידים ונקודות
✅ כרטיסי RFID לזיהוי תלמידים
✅ הודעות כלליות, לפי נקודות ופרטיות
✅ סינכרון דו-כיווני עם Excel
✅ ממשק עברי מלא עם RTL
✅ מצב עדכון מהיר לנקודות
✅ היסטוריית שינויי נקודות
✅ סטטיסטיקות (ממוצע כיתה וכללי) 📊
✅ מערכת בונוסים מתקדמת (בונוס מורה, בונוס מיוחד, בונוס זמנים)


════════════════════════════════════════════════════════════════
📁 קבצים עיקריים
════════════════════════════════════════════════════════════════

admin_station.py - עמדת ניהול
public_station.py - עמדה ציבורית
cashier_station.py - עמדת קופה
messages_manager.py - מנהל הודעות
database.py - מסד נתונים
excel_import.py - ייבוא/ייצוא Excel
messages.py - מערכת הודעות
color_editor.py - עורך צבעים


════════════════════════════════════════════════════════════════
📚 מדריכים/קבצי הוראות נוספים (מומלץ לפתוח כשצריך)
════════════════════════════════════════════════════════════════

מדריכי שימוש (HTML):
• guide_admin.html - מדריך מפורט למנהל מערכת
• guide_teacher.html - מדריך מפורט למורה

התקנה והפעלה:
• הוראות התקנה ראשוניות.html - מדריך התקנה למערכת מותקנת (EXE)
• הוראות_הפעלה_ללא_CMD.txt - הפעלה ללא חלון שחור (CMD)
• התקנה_מהירה.txt - 3 שלבים להתחלה
• מדריך_העברה_למחשב_חדש.txt - העברת המערכת למחשב חדש
• הוראות_התקנה_במחשב_נוסף.txt - התקנה בעמדה נוספת (רשת/DB/Excel)

תחזוקה/טכניקה:
• מידע_על_קבצי_מערכת.txt - אילו קבצים נוצרים ומה חובה לגבות
• הוראות_בניית_גרסת_התקנה_נקייה.txt - בניית התקנה נקייה ללא נתונים אישיים


════════════════════════════════════════════════════════════════
📊 סינכרון Excel
════════════════════════════════════════════════════════════════

קריאה מ-Excel:
──────────────
• בפתיחת תוכנה
• כל 2 דקות (אוטומטי)
• עמודות: G (כרטיס), H (נקודות), I (הודעה)

כתיבה ל-Excel:
──────────────
• אחרי עדכון בתוכנה
• בסגירת תוכנה
• רק עמודות G, H, I (לא דורס!)


════════════════════════════════════════════════════════════════
💬 מערכת הודעות
════════════════════════════════════════════════════════════════

1️⃣ הודעות כלליות:
   • תמיד מוצגות
   • רק בהצגת כרטיס

2️⃣ הודעות לפי נקודות:
   • טווח נקודות מינימום-מקסימום
   • הודעה מותאמת אישית

3️⃣ הודעות פרטיות:
   • לתלמיד ספציפי
   • מתעדכנות מ-Excel ומהתוכנה

4️⃣ חדשות/טיקר (בעמדה הציבורית):
   • חדשות שמוצגות כרצועת טיקר בתחתית המסך
   • ניתן להגדיר תאריך התחלה/סיום (תזמון)
   • יש אפשרות מהירות טיקר בהגדרות

   איך עובדים בפועל (ניהול חדשות):
   • פותחים: מנהל הודעות (run_messages.bat) או דרך כפתור "הודעות כלליות" בעמדת הניהול
   • מוסיפים פריט חדשות חדש
   • בשדות התאריך ניתן לבחור תאריך (Date Picker) כדי למנוע טעויות הקלדה
   • אם תאריך התחלה/סיום ריק – החדשות תמיד פעילות

5️⃣ פרסומות POP-UP (אם מופעל במערכת):
   • טבלת ads_items במסד הנתונים
   • ניתן להגדיר טקסט/תמונה, תאריכי תזמון וסדר

   הערות:
   • פרסומת יכולה להיות טקסט בלבד או תמונה
   • סדר תצוגה נקבע לפי sort_order (אם הוגדר)


════════════════════════════════════════════════════════════════
🎨 עיצוב וממשק
════════════════════════════════════════════════════════════════

• ממשק עברי מלא
• טקסט RTL (מימין לשמאל)
• צבעים מותאמים אישית
• גופנים ברורים וקריאים
• מסך מלא לעמדה ציבורית


════════════════════════════════════════════════════════════════
🔊 צלילים
════════════════════════════════════════════════════════════════

הצלילים נמצאים בתיקייה:
• sounds\ (ראה גם: sounds\README.txt)

עקרונות:
• מומלץ WAV (תאימות מלאה)
• MP3/OGG עובדים רק אם pygame זמין
• הצלילים ניתנים לבחירה מתוך עמדת הניהול (כולל כפתורי Play)

מבנה תיקיות (כללי):
• sounds\ - תיקייה ראשית
• ייתכנו תתי-תיקיות לפי סוג אירוע (למשל אנטי-ספאם/בונוסים/כללי)


════════════════════════════════════════════════════════════════
🛡️ אנטי-ספאם / חסימות
════════════════════════════════════════════════════════════════

בעמדה הציבורית קיימת מערכת אנטי-ספאם (כללים/חסימה/התרעה) בהתאם להגדרות המנהל.
במקרה של חסימה/התרעה מוצגת הודעה על המסך (כולל תמיכה טובה ב-RTL) וייתכן שיושמע צליל.


════════════════════════════════════════════════════════════════
🧾 עמדת קופה (Cashier)
════════════════════════════════════════════════════════════════

הפעלה:
• run_cashier.pyw

מה כוללת עמדת הקופה (ברמת משתמש):
• קטלוג מוצרים
• רכישות לתלמידים
• דוחות/ייצוא רכישות (Excel)
• (אופציונלי) מדפסת קבלות ותצוגה חיצונית

התקנה בעמדת קופה ייעודית:
• CashierPC\INSTALL_INSTRUCTIONS.txt


════════════════════════════════════════════════════════════════
🖥️ תצוגה חיצונית + מדפסת (אופציונלי)
════════════════════════════════════════════════════════════════

אם מחוברות תצוגה חיצונית/מדפסת, ההגדרות נמצאות ב-config.json:
• customer_display.enabled / com_port / baud_rate
• receipt_printer.port / baudrate

הערה:
• יש לוודא שהפורט (COM) נכון במחשב המקומי שבו מחוברים המכשירים.


════════════════════════════════════════════════════════════════
💾 גיבוי מומלץ (חשוב!)
════════════════════════════════════════════════════════════════

הקבצים הקריטיים לגיבוי:
• school_points.db (מסד הנתונים)
• קובץ ה-Excel המשותף ("טבלה למבצע אשראי.xlsx")

קבצים מומלצים לגיבוי בנוסף:
• db_path.txt, excel_path.txt
• bonus_settings.json, color_settings.json, config.json
• master_card.txt (וכרטיס מאסטר 2 אם קיים)

למידע מפורט:
• מידע_על_קבצי_מערכת.txt


════════════════════════════════════════════════════════════════
❓ תקלות נפוצות (קיצור)
════════════════════════════════════════════════════════════════

בעיה: "קובץ Excel לא נמצא" / "שגיאה בייבוא/ייצוא"
• בדוק שהנתיב ב-excel_path.txt נכון ונגיש
• ודא שקובץ ה-Excel לא פתוח באקסל בזמן ייצוא/ייבוא

בעיה: עמדות לא מסונכרנות / נתונים שונים בכל מחשב
• ודא שבכל מחשב db_path.txt מצביע לאותו school_points.db משותף

בעיה: אין צלילים / MP3 לא עובד
• נסה להשתמש ב-WAV
• ודא שהתקנת תלויות (requirements) כוללת pygame אם רוצים MP3/OGG


════════════════════════════════════════════════════════════════
🔧 תמיכה טכנית
════════════════════════════════════════════════════════════════

דרישות מערכת:
────────────
• Windows 10/11
• Python 3.8+
• קורא RFID (USB)

תלויות:
───────
• pandas
• openpyxl
• Pillow


════════════════════════════════════════════════════════════════
📊 סטטיסטיקות
════════════════════════════════════════════════════════════════

הצגה אוטומטית:
───────────────
• ממוצע נקודות הכיתה
• ממוצע נקודות כללי
• מתעדכן בזמן אמת

הפעלה/כיבוי:
─────────────
• בעמדת ניהול: סמן "📊 הצג סטטיסטיקות"
• השינוי נכנס לתוקף מיד


════════════════════════════════════════════════════════════════
📝 גרסה 7.4 - שינויים אחרונים
════════════════════════════════════════════════════════════════

✅ העברת הודעות לצד שמאל - לא מפריעות למספור! 📍
✅ התאמת ממשק לרזולוציות נמוכות (1360x780) 📐
✅ עיצוב קומפקטי - חיסכון של ~195 פיקסל
✅ הוספת סטטיסטיקות (ממוצע כיתה וכללי) 📊
✅ תיקון סינכרון דו-כיווני עם Excel
✅ תיקון קריאת הודעות פרטיות מ-Excel
✅ תיקון RTL מלא (כולל סימני קריאה)
✅ הסרת כפילויות בייבוא
✅ ייצוא חכם (רק עמודות G, H, I)
✅ שיפור ביצועים
✅ שדרוג מערכת הבונוסים בעמדה הציבורית:
   • הודעת בונוס מאוחדת כאשר תלמיד מקבל כמה סוגי בונוס יחד (לדוגמה: "קיבלת 2+8 (=10) נקודות בונוס")
   • שיפור פריסת פסי הבונוס (בונוס מורה / מיוחד / זמנים) כך שלא נחתכים גם במצב אורך
✅ בונוס מורה
   • מצב בונוס מורה נמשך גם אחרי פתיחה מחדש של העמדה הציבורית
   • תלמידים שכבר קיבלו בונוס מורה באותו סבב לא יקבלו אותו שוב בטעות
✅ עמדת ניהול
   • כפתור "החלף משתמש" לעבור במהירות בין מורים ללא סגירת התוכנה
   • מיון ברירת מחדל של טבלת תלמידים לפי מספר סידורי
   • הרחבת ייצוא/ייבוא לנתוני תיקופים וסטטיסטיקות נלוות


════════════════════════════════════════════════════════════════

תאריך: 15/12/2025
גרסה: 7.4
מפתח: מערכת ניקוד בית ספר

תהנה מהמערכת! 🎉
📊 עכשיו עם סטטיסטיקות!
📐 מותאם לרזולוציות נמוכות!
📍 הודעות בצד - לא מפריעות למספור!
